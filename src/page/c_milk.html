 <!DOCTYPE html>
<html lang="th">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>เครื่องมือคำนวณจำนวนนม</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

	<style>
		.container {
			max-width: 600px;
			margin-top: 15px;
			padding: 0 10px;
		}

		.output-box {
			font-size: 3.5rem;
			padding: 20px;
			background-color: #f8f9fa;
			border-radius: 12px;
			margin-bottom: 20px;
			border: 3px solid #007bff;
			font-weight: bold;
		}

		.btn-group-milk-format .btn {
			width: 100%;
			margin: 5px 0;
			white-space: normal;
			padding: 10px 5px;
			font-size: 0.9rem;
		}

		.btn-count-modifier .btn {
			flex-grow: 1;
			margin: 2px;
			padding: 10px 0;
			font-size: 1rem;
		}

		.current-value {
			font-weight: bold;
			color: #28a745;
		}

		.btn-milk-format.active {
			background-color: #007bff;
			color: white;
			border-color: #007bff;
		}

		/* ตกแต่งช่อง Input */
		.manual-input {
			max-width: 150px;
			margin: 10px auto;
			text-align: center;
			font-size: 1.2rem;
			font-weight: bold;
			border: 2px solid #28a745;
		}
	</style>
</head>

<body class="bg-light">

	<div class="container text-center">
		<h3 class="mt-3 mb-3">เครื่องมือคำนวณจำนวนนม</h3>

		<div class="output-box total-result-display">0</div>

		<div class="mb-4">
			<p class="mb-1">รูปแบบนมที่เลือก: <span id="displayMilkValue" class="current-value">0</span></p>
		</div>

		<hr>
		<h5 class="mt-4"> 1. เลือกรูปแบบนม </h5>
		<div class="row btn-group-milk-format">
			<script>
				const milkData = [
					[120, "นม 85 ml 120 ขวด"],
					[90, "นม 140 ml 90 ขวด"],
					[48, "ชาหมักเล็ก/โปรตีนเล็ก 48 ขวด"],
					[38, "ชาหมักใหญ่/โปรตีนใหญ่ 38 ขวด"],
					[25, "นม 400 ml 25 ขวด"],
					[30, "นม 300 ml 30 ขวด"],
					[16, "นม 700 ml 16 ขวด"],
					[24, "โยเกิร์ต 1 ถาด 24 ถ้วย"]
				];

				milkData.forEach(([value, text]) => {
					document.write(`
						<div class="col-6 col-sm-4">
							<button class="btn btn-outline-primary btn-milk-format" 
									onclick="setMilkFormat(${value}, this)">
								${text}
							</button>
						</div>`);
				});
			</script>
		</div>

		<hr>
		<h5 class="mt-4"> 2. ระบุจำนวนถาด </h5>
		<input type="number" id="inputTray" class="form-control manual-input" value="0" min="0" oninput="manualUpdate('tray')">
		
		<div class="d-flex flex-wrap justify-content-center btn-count-modifier mb-4">
			<button class="btn btn-success" onclick="adjustValue('tray', 1)">+1</button>
			<button class="btn btn-success" onclick="adjustValue('tray', 5)">+5</button>
			<button class="btn btn-success" onclick="adjustValue('tray', 10)">+10</button>
			<button class="btn btn-danger" onclick="adjustValue('tray', -1)">-1</button>
			<button class="btn btn-danger" onclick="adjustValue('tray', -5)">-5</button>
			<button class="btn btn-danger" onclick="adjustValue('tray', -10)">-10</button>
			<button class="btn btn-secondary" onclick="adjustValue('tray', 0)">รีเซ็ตถาด</button>
		</div>

		<hr>
		<h5 class="mt-4"> 3. ระบุจำนวนเศษ (ขวด) </h5>
		<input type="number" id="inputExtra" class="form-control manual-input" value="0" min="0" oninput="manualUpdate('extra')">

		<div class="d-flex flex-wrap justify-content-center btn-count-modifier mb-4">
			<button class="btn btn-success" onclick="adjustValue('extra', 1)">+1</button>
			<button class="btn btn-success" onclick="adjustValue('extra', 5)">+5</button>
				<button class="btn btn-success" onclick="adjustValue('extra', 10)">+10</button>
			<button class="btn btn-danger" onclick="adjustValue('extra', -1)">-1</button>
			<button class="btn btn-danger" onclick="adjustValue('extra', -5)">-5</button>
			<button class="btn btn-danger" onclick="adjustValue('extra', -10)">-10</button>

			<button class="btn btn-secondary" onclick="adjustValue('extra', 0)">รีเซ็ตเศษ</button>
		</div>
	</div>

	<script>
		let milkPerTray = 0;
		let trayCount = 0;
		let extraItems = 0;

		function updateDisplay() {
			const total = (milkPerTray * trayCount) + extraItems;
			document.querySelector('.total-result-display').innerText = total.toLocaleString();
			document.getElementById('displayMilkValue').innerText = milkPerTray;
			
			// อัปเดตค่าในช่อง Input ให้ตรงกับตัวแปร
			document.getElementById('inputTray').value = trayCount;
			document.getElementById('inputExtra').value = extraItems;
		}

		// ฟังก์ชันใหม่: อัปเดตเมื่อผู้ใช้พิมพ์ตัวเลขเอง
		function manualUpdate(type) {
			if (type === 'tray') {
				let val = parseInt(document.getElementById('inputTray').value);
				trayCount = isNaN(val) ? 0 : Math.max(0, val);
			} else if (type === 'extra') {
				let val = parseInt(document.getElementById('inputExtra').value);
				extraItems = isNaN(val) ? 0 : Math.max(0, val);
			}
			
			// คำนวณและอัปเดตเฉพาะยอดรวม (ไม่ย้อนกลับไปแก้ input เพื่อไม่ให้เคอร์เซอร์กระโดด)
			const total = (milkPerTray * trayCount) + extraItems;
			document.querySelector('.total-result-display').innerText = total.toLocaleString();
		}

		function setMilkFormat(value, buttonElement) {
			milkPerTray = value;
			document.querySelectorAll('.btn-milk-format').forEach(btn => btn.classList.remove('active'));
			buttonElement.classList.add('active');
			updateDisplay();
		}

		function adjustValue(type, amount) {
			if (type === 'tray') {
				trayCount = (amount === 0) ? 0 : Math.max(0, trayCount + amount);
			} else if (type === 'extra') {
				extraItems = (amount === 0) ? 0 : Math.max(0, extraItems + amount);
			}
			updateDisplay();
		}

		window.onload = updateDisplay;
	</script>
</body>
</html>
